<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Unlock My Heart ‚ù§</title>
<style>
  :root{--bg:#fff8f5;--card:#ffffff;--accent:#ff6b81;--muted:#6b6b6b;--tile:#fff1f3}
  body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; background:linear-gradient(180deg,#fffaf6 0%, #fff8f5 100%); color:#222}
  .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px;}
  .card{width:920px;max-width:95%;background:var(--card);border-radius:18px;box-shadow:0 10px 30px rgba(10,20,40,0.06);padding:28px;overflow:hidden;position:relative}
  header{display:flex;gap:16px;align-items:center}
  .avatar{width:76px;height:76px;border-radius:12px;background:linear-gradient(135deg,#0aa5a5,#2bb0ff);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:22px;flex:0 0 76px}
  h1{font-size:20px;margin:0}
  p.lead{margin:6px 0 0;color:var(--muted)}
  .game{display:flex;gap:24px;margin-top:20px;flex-wrap:wrap}
  .left{flex:1;min-width:260px}
  .right{width:420px;flex:0 0 420px}
  .box{background:#fbfbfd;border-radius:12px;padding:14px;box-shadow:inset 0 1px 0 rgba(0,0,0,0.02)}
  .tiles{display:flex;flex-wrap:wrap;gap:10px;padding:12px;min-height:74px}
  .tile{background:var(--tile);padding:10px 14px;border-radius:10px;border:1px solid rgba(0,0,0,0.05);cursor:grab;font-weight:600;user-select:none}
  .dropzone{min-height:56px;border:2px dashed rgba(10,20,40,0.06);border-radius:10px;padding:10px;display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .actions{display:flex;gap:10px;margin-top:12px;align-items:center}
  button{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:700}
  button.ghost{background:transparent;color:var(--accent);border:1px solid rgba(255,107,129,0.15)}
  small.hint{color:var(--muted);display:block;margin-top:8px}
  .final{display:none;padding:18px;border-radius:12px;text-align:center}
  .letter{font-size:16px;line-height:1.6;color:#112;white-space:pre-wrap;text-align:left;max-height:280px;overflow:auto}
  .heart{font-size:48px;color:var(--accent);opacity:0;transform:scale(0.6);transition:all .6s ease}
  .confetti {position:absolute;left:0;right:0;top:0;bottom:0;pointer-events:none}
  .footer{margin-top:14px;color:var(--muted);font-size:13px}
  /* typing cursor */
  .typed{border-right:2px solid rgba(0,0,0,0.08);padding-right:6px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" role="main" aria-labelledby="title">
    <header>
      <div class="avatar">SN</div>
      <div>
        <h1 id="title">Unlock My Heart ‚ù§</h1>
        <p class="lead">Solve the small puzzle to read a letter I wrote for you. Take your time ‚Äî think of the moments.</p>
      </div>
    </header>

    <div class="game">
      <div class="left">
        <div class="box">
          <div><strong>Arrange these words into a sentence</strong></div>
          <div class="tiles" id="scrambled"></div>
          <div style="margin-top:12px"><small class="hint">Tip: the completed sentence starts with <em>"Thank"</em> ‚Äî but no rush.</small></div>
        </div>

        <div style="height:18px"></div>

        <div class="box">
          <div><strong>Your Answer</strong></div>
          <div class="dropzone" id="answer" aria-live="polite" aria-label="Drop zone for arranged words"></div>
          <div class="actions">
            <button id="check">Check</button>
            <button class="ghost" id="shuffle">Shuffle</button>
            <button class="ghost" id="hintBtn">Reveal 1 word</button>
          </div>
          <small class="hint">You can drag tiles into the answer zone, rearrange them, then click Check.</small>
        </div>
      </div>

      <div class="right">
        <div class="box" style="display:flex;flex-direction:column;align-items:center;gap:12px;height:100%">
          <div style="text-align:center">
            <div style="font-weight:700;color:#0a2540">When solved</div>
            <div style="color:var(--muted);margin-top:6px">A letter will appear and a song will play.</div>
          </div>

          <div class="final" id="finalCard" role="status" aria-hidden="true">
            <div class="heart" id="heart">‚ù§</div>
            <div class="letter typed" id="letter"></div>
            <div style="margin-top:12px">
              <button id="replay" class="ghost">Play again</button>
            </div>
          </div>

          <div style="margin-top:auto" class="footer">
            <div>Made with care üíå</div>
            <div style="font-size:12px;color:var(--muted)">Hint button is a gentle nudge ‚Äî don't rush the magic.</div>
          </div>
        </div>
      </div>
    </div>

    <audio id="bgAudio" preload="auto">
      <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio>

    <div class="confetti" id="confetti"></div>
  </div>
</div>

<script>
/* Puzzle words: final sentence = "Thank you for being in my life" */
const solution = ["Thank","you","for","being","in","my","life"];
let tiles = [...solution].sort(()=>Math.random()-0.5);

const scrambled = document.getElementById('scrambled');
const answer = document.getElementById('answer');
const checkBtn = document.getElementById('check');
const shuffleBtn = document.getElementById('shuffle');
const hintBtn = document.getElementById('hintBtn');
const finalCard = document.getElementById('finalCard');
const letterEl = document.getElementById('letter');
const heart = document.getElementById('heart');
const audio = document.getElementById('bgAudio');
const replay = document.getElementById('replay');

function renderTiles(){
  scrambled.innerHTML = '';
  tiles.forEach((t,i)=>{
    const el = document.createElement('div');
    el.className='tile';
    el.draggable=true;
    el.id = 'tile-'+i;
    el.textContent = t;
    el.addEventListener('dragstart', dragStart);
    scrambled.appendChild(el);
  });
}
function renderAnswer(){
  // nothing here; drop zone holds nodes
}
function dragStart(e){
  e.dataTransfer.setData('text/plain', e.target.id);
}
function allowDrop(e){ e.preventDefault(); }
function dropTile(e){
  e.preventDefault();
  const id = e.dataTransfer.getData('text/plain');
  const node = document.getElementById(id);
  if(node){
    answer.appendChild(node);
  }
}
scrambled.addEventListener('dragover', allowDrop);
scrambled.addEventListener('drop', (e)=>{ e.preventDefault(); const id = e.dataTransfer.getData('text/plain'); const node = document.getElementById(id); if(node) scrambled.appendChild(node); });
answer.addEventListener('dragover', allowDrop);
answer.addEventListener('drop', dropTile);

shuffleBtn.addEventListener('click', ()=>{
  tiles = tiles.sort(()=>Math.random()-0.5);
  renderTiles();
});

hintBtn.addEventListener('click', ()=>{
  // reveal next missing correct word in answer
  const current = Array.from(answer.children).map(n=>n.textContent);
  const missing = solution.filter((w,i)=> current[i] !== w);
  if(missing.length){
    const revealWord = missing[0];
    // find tile with that word in scrambled
    const tileNode = Array.from(document.querySelectorAll('.tile')).find(n=>n.textContent===revealWord);
    if(tileNode) answer.appendChild(tileNode);
  }
});

checkBtn.addEventListener('click', ()=>{
  const current = Array.from(answer.children).map(n=>n.textContent.trim());
  if(current.length !== solution.length){
    alert('Almost there ‚Äî place all words in correct order.');
    return;
  }
  const ok = solution.every((w,i)=> w === current[i]);
  if(ok){
    revealLetter();
  } else {
    // gentle feedback & nudge
    shake(answer);
    setTimeout(()=>{ alert('Not quite ‚Äî try reading the sentence out loud.') }, 400);
  }
});

function shake(el){
  el.style.transition='transform .08s';
  el.style.transform='translateX(-6px)';
  setTimeout(()=>el.style.transform='translateX(6px)',80);
  setTimeout(()=>el.style.transform='translateX(0)',160);
  setTimeout(()=>el.style.transition='',240);
}

function revealLetter(){
  // show final card
  finalCard.style.display='block';
  finalCard.setAttribute('aria-hidden','false');
  heart.style.opacity=1;
  heart.style.transform='scale(1)';
  playAudioOnce();
  // typing effect for letter
  const letter = `My dearest,\n\nThank you for being in my life.\n\nYou turn ordinary days into something beautiful. Your kindness, laughter, and quiet strength mean more to me than I can say.\n\nI feel lucky every single day that you chose to share your time with me.\n\nAlways,\nSayak ‚ù§Ô∏è`;
  typeText(letterEl, letter, 25);
  // confetti
  setTimeout(()=>fireConfetti(), 800);
}

function typeText(el, text, speed=40){
  el.textContent='';
  let i=0;
  const t = setInterval(()=> {
    el.textContent += text[i] === '\n' ? '\n' : text[i];
    i++;
    if(i>=text.length){ clearInterval(t); el.classList.remove('typed'); }
  }, speed);
  el.classList.add('typed');
}

function playAudioOnce(){
  // browsers need a user gesture to allow audio; solving is a gesture
  try{
    audio.currentTime = 0;
    audio.volume = 0.85;
    audio.play().catch(()=>{ /* ignore */ });
  }catch(e){}
}

function fireConfetti(){
  // very small canvas confetti using basic elements (no library)
  const c = document.getElementById('confetti');
  c.innerHTML='';
  const colors = ['#ff6b81','#ffd166','#06d6a0','#4cc9f0','#a0c4ff'];
  for(let i=0;i<28;i++){
    const el = document.createElement('div');
    el.style.position='absolute';
    el.style.left = (Math.random()*100)+'%';
    el.style.top = '-10%';
    el.style.width = (6+Math.random()*10)+'px';
    el.style.height = (8+Math.random()*12)+'px';
    el.style.background = colors[Math.floor(Math.random()*colors.length)];
    el.style.borderRadius='2px';
    el.style.transform = 'rotate('+ (Math.random()*360) +'deg)';
    el.style.opacity = '0.95';
    el.style.transition = 'transform 1.6s linear, top 1.6s linear, left 1.6s linear, opacity 2s linear';
    c.appendChild(el);
    setTimeout(((el,idx)=>{
      return ()=> {
        el.style.top = (60+Math.random()*40)+'%';
        el.style.left = (10+Math.random()*80)+'%';
        el.style.transform = 'rotate('+ (Math.random()*720) +'deg) translateY(40px)';
        el.style.opacity = '0';
      };
    })(el,i), 40*i);
  }
  setTimeout(()=>{ c.innerHTML=''; }, 2600);
}

replay.addEventListener('click', ()=>{ audio.currentTime=0; audio.play().catch(()=>{}); });

/* initial render */
renderTiles();

/* unorthodox minor UX tips built-in: gentle hint after 20s if idle */
let idleTimer = setTimeout(()=>{ hintBtn.click(); }, 20000);
document.addEventListener('click', ()=>{ clearTimeout(idleTimer); });

/* accessibility: keyboard support for check via Enter when focus on answer */
answer.tabIndex = 0;
answer.addEventListener('keydown', (e)=>{ if(e.key==='Enter') checkBtn.click(); });

</script>
</body>
</html>
